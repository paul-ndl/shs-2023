/*! For license information please see zephr.bundle.min.js.LICENSE.txt */
!function(){"use strict";function e(e){const t=document.documentElement,o=document.body;if(!0===e){if(t.scrollHeight>t.offsetHeight){const e=t.scrollTop?t.scrollTop:o.scrollTop;t.classList.add("no-scroll"),t.style.top=-e+"px"}}else{const e=-parseInt(t.style.top,10);t.classList.remove("no-scroll"),t.scrollTop=e,o.scrollTop=e}}function t(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)e[n]=o[n]}return e}var o=function e(o,n){function r(e,r,s){if("undefined"!=typeof document){"number"==typeof(s=t({},n,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var c in s)s[c]&&(i+="; "+c,!0!==s[c]&&(i+="="+s[c].split(";")[0]));return document.cookie=e+"="+o.write(r,e)+i}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],n={},r=0;r<t.length;r++){var s=t[r].split("="),i=s.slice(1).join("=");try{var c=decodeURIComponent(s[0]);if(n[c]=o.read(i,c),e===c)break}catch(e){}}return e?n[e]:n}},remove:function(e,o){r(e,"",t({},o,{expires:-1}))},withAttributes:function(o){return e(this.converter,t({},this.attributes,o))},withConverter:function(o){return e(t({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(o)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const n={ls:window.localStorage,isLsAvailable(){const e="test";try{return n.ls.setItem(e,e),n.ls.removeItem(e),!0}catch(e){return this.throwError(e),!1}},throwError(e,t="error"){console[t](`[NYP Storage] An error has occurred: ${e}`)},set(e,t,r){const s=r;let i=t;if(void 0!==r){if("object"!=typeof r)return this.throwError('The "attributes" parameter must be an object.',"warn"),!1;s.value=t,i=s}if(!n.isLsAvailable())return this.throwError("Local Storage is not available, action was completed using cookies","warn"),o.set(e,t,r);try{return this.ls.setItem(e,JSON.stringify(i)),!0}catch(e){return this.throwError(e),!1}},get(e,t=!0){if(!n.isLsAvailable())return this.throwError("Local Storage is not available, action was completed using cookies","warn"),o.get(e);try{return t?JSON.parse(this.ls.getItem(e)):this.ls.getItem(e)}catch(e){return this.throwError(e),!1}},remove(e){if(!n.isLsAvailable())return this.throwError("Local Storage is not available, tried removing via Cookies."),o.remove(e),!1;try{return this.ls.removeItem(e),!0}catch(e){return this.throwError(e),!1}},hasCookie(e){return void 0!==o.get(e)||!1}};var r=n;const s="nyp_zephr",i="__all";function c(){let e=r.get(s);return e||(e={}),Object.assign({subscribed:[],suppressed:{},suppressedAllowList:[]},e)}function l(e){r.set(s,e)}function a(){const e=Math.floor(Date.now()/1e3),t=c();let{suppressedAllowList:o=[]}=t;if(!o.length)return!1;const[n="",r=0]=o;return r<=e?(o=[],l(t),!1):n}function p(e=!1){e||(e=i);const t=c(),{suppressed:o=[]}=t,n=Math.floor(Date.now()/1e3),r=a();return!((!r||e===i||r===e)&&(void 0===o[e]||o[e]<=n&&(delete o[e],l(t),1)))}const d=document.documentElement.clientWidth<=640;function u(e,t,o,n){const{fireToEmbed:r=console.error}=window.zephr;r(e,{success:t,message:o,isMobile:d,object:"string"==typeof n?n.replace("zephr:event:",""):n})}function h(e,t,o,n="",r=""){let s=e||n;r&&r.length||(r="Flyout: "),s?s.startsWith("flyout ")?s=s.replace(/-/g," ").replace(/^(.)|\s+(.)/g,(e=>e.toUpperCase())).replace(/^Flyout /,"").replace(/ Left$/,"").replace(/ Right$/,""):s.startsWith("pencil-unit ")&&(s=s.replace("pencil-unit ","").trim()):s="Template name not defined - Zephr",s=`${r}${s}`,"function"==typeof window.ga&&window.ga("send","event",s,t,o)}function w(e){const{email:t="",event:o,iframeId:n="",nypPhone:r="",maropostsource:s="",experienceActionId:i="",zephrComponent:a="",selectedLists:p={},towersource:d="nypost"}=e;let{lists:w="",source:m="",model:{templateName:f=""}={}}=e;const{model:{GAPrefix:v=""}={}}=e;w=function(e){return e.split(",").map((e=>e.trim())).filter((e=>e.length>1)).join(",")}(w),m=m||s,t&&w?(f=f||i||a,async function(e,t){try{const o=await fetch("https://developer.nypost.com/temp/maropost/webhooks/validate-email/",{body:`email=${encodeURIComponent(e)}&tower_source=${encodeURIComponent(t)}`,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"POST"});if(!o.ok)return!0;const{pass:n=!0}=await o.json();return n}catch(e){return!0}}(t,d).then((s=>{if(s){!async function(e,t,o,n,r,s){const{nypZephr:{nonce:i=""}={}}=window,c=r.hasOwnProperty("trackingId")?r.trackingId:"",l=await fetch("/wp-json/nypost-zephr/v1/newsletters/",{body:(a={email:e,subscribe:t,_wpnonce:i,nypPhone:o,source:n,tpEvent:c},Object.keys(a).reduce(((e,t)=>[...e,`${t}=${encodeURIComponent(a[t])}`]),[]).join("&")),headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST"});var a;if(!l.ok)return void u(s,!1,"An error has ocurred.",r.event);const{status:p=!1}=await l.json()||{};p?u(s,!0,"Success",r.event):u(s,!1,"An error has ocurred.",r.event)}(t,w,r,m,e,n),window.newslettersConverted=window.newslettersConverted||[];const s=Object.values(p).filter((e=>!window.newslettersConverted.includes(e)));h(f,"newsletter-single-signup"===o?"Submit - Single Signup":"Submit - Multiple",`Converted: ${s.join(", ")}`,a,v);const{permutive:i=!1}=window;i&&i.track("Newsletter",{pageUri:window.location.href,newsletters:s.join(", ")}),window.newslettersConverted.push(...s),function(e){const t=c(),{subscribed:o=[]}=t;o.push(e),l(t)}(a)}else u(n,!1,"An error has ocurred.","invalid-email"),h(f,"Submit","FAIL: EMAIL DOES NOT EXIST (TOWER API)",a,v)})).catch((()=>{h(f,"Submit","FAIL: EMAIL DOES NOT EXIST (TOWER API)",a,v),u(n,!1,"An error has ocurred.","invalid-email")}))):u(n,!1,"An error has ocurred. Missing email address or list IDs.",e.event)}window.nypZephr=window.nypZephr||{},window.zephr=window.zephr||[],window.nypZephr.isMobile=d,window.zephr.push(["loaded",e=>{u(e.iframeId,!0,"isMobile",{isMobile:d})}]),window.zephr.push(["flyout-close",t=>{const{iframeId:o="",eventAction:n="Button Click - Close",eventLabel:r="X button close",model:{disableScrollLock:s=!1,disableMobileScrollLock:i=!1,GAPrefix:c="",templateName:l=""}={},zephrComponent:a=""}=t;if(d&&!(s||i)&&e(!1),!o)return;const p=document.getElementById(o);if(p){const e=p.closest(".zephr-component");e&&!e.classList.contains("closed")&&(e.classList.add("closed"),h(l,n,r,a,c))}}]),window.zephr.push(["show",t=>{const{model:{disableScrollLock:o=!1,disableMobileScrollLock:n=!1,GAPrefix:r="",templateName:s=""}={},zephrComponent:i=""}=t,a=o||n;h(s,"Show Template",window.location.href.split("?").shift(),i,r),function(e,t=86400){const o=Math.floor(Date.now()/1e3),n=c();n.suppressedAllowList=[e,o+t],l(n)}(s||i),d&&!a&&e(!0)}]),window.zephr.push(["*",e=>{const{event:t,eventAction:o="",eventLabel:n="",model:{GAPrefix:r="",templateName:s=""}={},zephrComponent:i=""}=e;"flyout-close"!==t&&(-1===t.indexOf("-clicked")&&-1===t.indexOf("-close")&&"track-analytics"!==t||h(s,o||t,n||t,i,r))}]),window.zephr.push(["newsletter-single-signup",w]),window.zephr.push(["newsletter-multi-signup",w]);const m=()=>{const{hooks:{addFilter:e=(()=>null)}={}}=window.zephr;e("zephr.componentQueryParameters","nypost",(e=>{e.append("theme","nypost-2021"),p(i)&&e.append("suppressAll","true");const t=a();return t&&e.append("suppressedExcept",t),e})),e("zephr.componentProps","nypost",((e,t,o)=>!!function(e){const{subscribed:t=[]}=c()||{},{env:o="local"}=window.nypZephr||{};return!(("production"===o||!window.location.hash.includes("zephrRender=1"))&&(t.includes(e)||p(i)||"local"===o&&p(e)))}(o)&&e))};window.zephr.booted?m():window.zephr.push(["boot",m])}();
//# sourceMappingURL=zephr.bundle.min.js.map