(window.fignlWebpackJsonp=window.fignlWebpackJsonp||[]).push([[1],{123:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){if(window.dataLayer)try{window.dataLayer.push(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{event:"customEventSPE"}))}catch(e){console.warn("[Widget Newsletter] Failed to track",e)}}n(98),n(110),n(111),n(60),n(124),n(100),n(113),n(53),n(115),n(116),n(118),n(125),n(126),n(127),n(52),n(119),n(101),n(103),n(122),n(136),Object.defineProperty(t,"__esModule",{value:!0}),t.trackSubscriptionSuccess=function(e){var t=e.trackingData,n=e.newsletter,r=t.pageCategory,a=t.articleId,i=n.name,c=n.id,s=n.isPremium?"premium":"gratuite";o({customCategorie:"engagement",customAction:"subscribeNewsletter_Success",customLabel:a?"".concat(r,"_").concat(i,"_").concat(a,"_").concat(s,"_").concat(c):"".concat(r,"_").concat(i,"_").concat(s,"_").concat(c)})},t.trackSeeNewsletters=function(e){var t=e.pageCategory,n=e.articleTitle,r=e.articleId,a=n&&r?"".concat(t,"_").concat(n,"_").concat(r):t;o({customCategorie:"navigation",customAction:"blocIDClic",customLabel:"bloc_inscription_NL_".concat(a)})},t.buildSeeNewslettersLink=function(e){var t=new URL("https://client.lefigaro.fr/WebloggiaLeFigaro/espaceclient/newsletters"),n={utm_source:e.site,utm_medium:"banner",utm_campaign:"bloc_inscription_".concat(e.pageCategory)};return Object.entries(n).forEach((function(e){var n,a,i=(a=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}}(n,a)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(n,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=i[0],c=i[1];return t.searchParams.append(o,c)})),t.href}},129:function(e,t,n){"use strict";e.exports=n(147)},131:function(e,t,n){"use strict";n(98),n(110),n(111),n(100),n(113),n(53),n(115),n(116),n(134),n(118),n(52),n(119),n(101),n(103),n(122),Object.defineProperty(t,"__esModule",{value:!0}),t.createDom=function(e){var t=e.rootNode,n=e.newsletter,a=e.connected,i=e.variant,s=e.widgetCpt,u=e.trackingData,l=n.name,f=n.description,p=n.periodicity;t.classList.add("fignl"),t.classList.add("article"===i?"fignl--article":"fignl--hp");var d=o("h3",{innerText:"".concat(l),className:"fignl__title"}),m=o("span",{innerText:"Newsletter",className:"fignl__title-suffix"});d.appendChild(m);var g=o("p",{innerText:p,className:"fignl__periodicity"}),b=o("p",{innerText:f,className:"fignl__description"}),h=o("form",{className:"fignl__form"}),v=null,w=o("p",{innerText:"Merci de renseigner une adresse e-mail valide",className:"fignl__error"});if(t.appendChild(d),t.appendChild(g),t.appendChild(b),!a){var y="fignl-email-".concat(s);h.appendChild(o("label",{innerText:"Adresse e-mail",htmlFor:y,className:"fignl__label"})),v=o("input",{type:"email",required:"required",id:y,className:"fignl__input"}),w.setAttribute("aria-hidden",!0),v.addEventListener("focus",(function(){v.classList.remove("fignl__input--error"),w.classList.remove("fignl__error--show"),w.setAttribute("aria-hidden",!0)})),h.appendChild(v),h.appendChild(w)}return h.appendChild(o("button",{innerText:"S'inscrire",className:"fignl__btn"})),t.appendChild(h),{setOnSubmit:function(e){h.addEventListener("submit",(function(t){var n=v&&v.value;e(n),t.preventDefault()}))},onInvalidEmail:function(){w.classList.add("fignl__error--show"),w.setAttribute("aria-hidden",!1),v.classList.add("fignl__input--error")},onSubscriptionSuccess:function(){d.innerText="Félicitations !",c(g),b.innerHTML='Vous êtes désormais inscrit à la newsletter <span class="fignl__name">'.concat(l,"</span>. Découvrez d'autres newsletters susceptibles de vous intéresser en cliquant ci-dessous."),c(h),t.classList.add("fignl--success"),t.appendChild(o("a",{innerText:"Voir d'autres newsletters",target:"_blank",rel:"noopener",onclick:function(){(0,r.trackSeeNewsletters)(u)},href:(0,r.buildSeeNewslettersLink)(u),className:"fignl__btn-link"})),window.innerWidth<768&&t.scrollIntoView({behavior:"smooth",block:"nearest"})}}};var r=n(123);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(r=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},t),r=document.createElement(e);return Object.entries(n).forEach((function(e){var t=a(e,2),n=t[0],i=t[1];r[n]=i})),r}function c(e){e.parentNode.removeChild(e)}},140:function(e,t,n){"use strict";n(98),n(60),n(124),n(100),n(107),n(125),n(126),n(127),n(52),n(57),n(141),n(103),Object.defineProperty(t,"__esModule",{value:!0}),t.getNewsletter=function(e){return g.apply(this,arguments)},t.subscribeToNewsletter=function(e){return b.apply(this,arguments)},t.INVALID_EMAIL=void 0,n(59);var r=o(n(145)),a=o(n(146)),i=o(n(129));function o(e){return e&&e.__esModule?e:{default:e}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){l(i,r,a,o,c,"next",e)}function c(e){l(i,r,a,o,c,"throw",e)}o(void 0)}))}}function p(){return{"X-Figaro-App-Name":"Widget-Comments - ".concat(window.location.hostname," - Web"),"X-Figaro-App-Version":"v1.1.1"}}function d(e){return m.apply(this,arguments)}function m(){return(m=f(regeneratorRuntime.mark((function e(t){var n,a,o,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query,a=t.variables,o="".concat(i.default.apis.graphMutations,"/graphql?"),e.next=4,(0,r.default)(o,{method:"POST",headers:s({Accept:"application/json","Content-Type":"application/json"},p()),body:JSON.stringify({query:n,variables:a})});case 4:return c=e.sent,e.next=7,c.json();case 7:if(!(u=e.sent).errors||!u.errors.length){e.next=14;break}if(!u.errors[0].message.toLowerCase().includes("invalid email")){e.next=13;break}throw new Error("INVALID_EMAIL");case 13:throw new Error("Graphql call failed".concat(u.errors[0].message));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=f(regeneratorRuntime.mark((function e(t){var n,o,c,s,u,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.default.getNewsletter,o={id:t},c=i.default.apis.graphExt,s="".concat(c,"/graphql?id=").concat(n,"&variables=").concat(JSON.stringify(o)),e.next=6,(0,r.default)(s,{headers:p()});case 6:return u=e.sent,e.next=9,u.json();case 9:if(l=e.sent,f=l.data.newsletters[0]){e.next=13;break}throw new Error("Newsletter ".concat(t," not found on ").concat(c));case 13:return e.abrupt("return",f);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=f(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.newsletterId,r=t.email,a=t.token,'\n    mutation subscribeWithEmail(\n      $newsletterId: ID!,\n      $email: Email,\n      $token: String\n    ) {\n      addNewsletterSubscription(\n          input: {\n              id: $newsletterId,\n              email: $email,\n              token: $token,\n              eventCode: "GRAPHQL"\n          }\n      ) {\n        id\n      }\n    }',e.abrupt("return",d({query:'\n    mutation subscribeWithEmail(\n      $newsletterId: ID!,\n      $email: Email,\n      $token: String\n    ) {\n      addNewsletterSubscription(\n          input: {\n              id: $newsletterId,\n              email: $email,\n              token: $token,\n              eventCode: "GRAPHQL"\n          }\n      ) {\n        id\n      }\n    }',variables:s({newsletterId:n},a?{token:a}:{email:r})}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.INVALID_EMAIL="INVALID_EMAIL"},146:function(e){e.exports=JSON.parse('{"getNewsletter":"widget-newsletter_getNewsletter_3a3e8c17a5038c4609e93ea40558bc62dd6a871794b60c39d2a63fea0a203e62"}')},147:function(e,t,n){"use strict";e.exports={agoraCookie:"fig_user_info",apis:{graphExt:"https://api-graphql.lefigaro.fr",graphInt:"https://api-graphql-int.lefigaro.fr",graphMutations:"https://api-graphql-mutations.lefigaro.fr",users:"https://user-agora.lefigaro.fr",agora:"https://connect.lefigaro.fr"},publicPath:"https://static.lefigaro.fr/agora/widget-newsletter/",port:9e3}},148:function(e,t,n){"use strict";n(52),n(57),n(130),n(150),Object.defineProperty(t,"__esModule",{value:!0}),t.checkSessionAndGetToken=function(){return c.apply(this,arguments)},t.isUserConnected=function(){return e=a.default.agoraCookie,t=document.cookie.match("(^|[^;]+)\\s*".concat(e,"\\s*=\\s*([^;]+)")),!(!t||!t.pop());var e,t},n(59);var r,a=(r=n(129))&&r.__esModule?r:{default:r};function i(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){i(o,r,a,c,s,"next",e)}function s(e){i(o,r,a,c,s,"throw",e)}c(void 0)}))}}function c(){return(c=o(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(a.default.apis.agora,"/users/infos"),{credentials:"include"});case 2:if((t=e.sent).ok){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,t.json();case 7:return n=e.sent,r=n.token,e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},96:function(e,t,n){"use strict";n(107),n(52),n(57),n(59);var r=n(131),a=n(140),i=n(148),o=n(123);function c(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){c(i,r,a,o,s,"next",e)}function s(e){c(i,r,a,o,s,"throw",e)}o(void 0)}))}}function u(e){return l.apply(this,arguments)}function l(){return(l=s(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.newsletterId,!(r=t.email)){e.next=6;break}return e.next=4,(0,a.subscribeToNewsletter)({newsletterId:n,email:r});case 4:e.next=11;break;case 6:return e.next=8,(0,i.checkSessionAndGetToken)();case 8:return o=e.sent,e.next=11,(0,a.subscribeToNewsletter)({newsletterId:n,token:o});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){var t=e.newsletterId,n=e.rootNode,r=e.variant,a=e.site,i=e.trackingData;if(!(t&&n&&r&&a&&["lefigaro","madame"].includes(a)&&i&&i.site&&i.pageCategory))throw new Error("Some parameters are invalid or missing, check the docs")}var p=0;function d(e){"madame"===e?n.e(3).then(n.t.bind(null,154,7)):n.e(4).then(n.t.bind(null,156,7))}window.fignewsletter.displayWidget=function(){var e=s(regeneratorRuntime.mark((function e(t){var n,c,l,m,g,b,h,v,w,y,_,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.newsletterId,c=t.rootNode,l=t.variant,m=t.site,g=void 0===m?"lefigaro":m,b=t.trackingData,e.prev=1,f({newsletterId:n,rootNode:c,variant:l,site:g,trackingData:b}),d(g),h=(0,i.isUserConnected)(),e.next=7,(0,a.getNewsletter)(n);case 7:v=e.sent,w=(0,r.createDom)({rootNode:c,newsletter:v,connected:h,variant:l,widgetCpt:p++,trackingData:b}),y=w.setOnSubmit,_=w.onInvalidEmail,k=w.onSubscriptionSuccess,y(function(){var e=s(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u({newsletterId:n,email:t});case 3:(0,o.trackSubscriptionSuccess)({trackingData:b,newsletter:v}),k(),e.next=14;break;case 7:if(e.prev=7,e.t0=e.catch(0),e.t0.message!==a.INVALID_EMAIL){e.next=13;break}_(),e.next=14;break;case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("[Widget Newsletter]",e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}()}}]);